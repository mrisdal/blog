<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Why and how I made a micro Cantonese podcast - Meg Risdal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="https://www.meg.dev/favicon.png">
  <link rel="canonical" href="https://www.meg.dev/posts/micro-canto-pod/" />

  
  
  <link rel="stylesheet" href="/css/style.min.3ff7c63a19303dba122a564587e692358947b9cd1c86347703e5366fe5eab7c1.css">
  

  
    <meta name="description" content="Right now I&#39;m learning how to speak Cantonese. There are many strategies to learn a language, but using the language daily is one I hear often. This blog post is about the &#39;micro Cantonese podcast&#39; I&#39;m starting as a way to force myself to practice Cantonese every day."/>
    <meta property="og:title" content="Why and how I made a micro Cantonese podcast"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://www.meg.dev/posts/micro-canto-pod/"/>
    <meta property="og:image" content="https://www.meg.dev/images/rabbit_banner.png"/>
    <meta property="og:description" content="Right now I&#39;m learning how to speak Cantonese. There are many strategies to learn a language, but using the language daily is one I hear often. This blog post is about the &#39;micro Cantonese podcast&#39; I&#39;m starting as a way to force myself to practice Cantonese every day."/>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="@meganrisdal"/>
    <meta name="twitter:creator" content="@meganrisdal"/>
  

  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet"> 
</head>




<body class='page frame page-blog-single'>
  <div id="menu-main-mobile" class="menu-main-mobile">
    <ul class="menu">
        
        
            
                <li class="menu-item-home">
                    <a href="https://www.meg.dev/">Home</a>
                </li>
            
        
            
                <li class="menu-item-blog">
                    <a href="https://www.meg.dev/posts/">Blog</a>
                </li>
            
        
            
                <li class="menu-item-cantonese">
                    <a href="https://www.meg.dev/pages/cantonese/">Cantonese</a>
                </li>
            
        
            
                <li class="menu-item-about">
                    <a href="https://www.meg.dev/about/">About</a>
                </li>
            
        
            
                <li class="menu-item-contact">
                    <a href="https://www.meg.dev/contact/">Contact</a>
                </li>
            
        
    </ul>
</div>
  <div id="wrapper" class="wrapper">
    <div class='header'>
  <link rel="alternate"
      type="application/rss+xml"
      href="https://www.meg.dev//feed.xml"
      title="Meg Risdal">
  <link rel="alternate" type="application/rss+xml" href="https://www.meg.dev//feed.xml" title="Meg Risdal">
  <a class="header-logo" href="/">Meg Risdal</a>
  <div class="menu-main">
    <ul>
      
      
      
      
      <li class="menu-item-home ">
        <a href="/">
          
          <span>Home</span>
        </a>
      </li>
      
      
      
      <li class="menu-item-blog active">
        <a href="/posts/">
          
          <span>Blog</span>
        </a>
      </li>
      
      
      
      <li class="menu-item-cantonese ">
        <a href="/pages/cantonese/">
          
          <span>Cantonese</span>
        </a>
      </li>
      
      
      
      <li class="menu-item-about ">
        <a href="/about/">
          
          <span>About</span>
        </a>
      </li>
      
      
      
      <li class="menu-item-contact ">
        <a href="/contact/">
          
          <span>Contact</span>
        </a>
      </li>
      
    </ul>
  </div>
  <div id="toggle-menu-main-mobile" class="hamburger-trigger">
    <button class="hamburger">Menu</button>
  </div>
</div>
    
  <div class="blog">
    
    <div class="intro">
      <h1>Why and how I made a micro Cantonese podcast<span class="dot">.</span></h1>
      
      <img src="/images/rabbit_banner.png" />
      
    </div>
    <div class="content">
      <p>Right now I&rsquo;m learning how to speak Cantonese. There are many strategies to learn a language, but using the language daily is one I hear often. This blog post is about the &ldquo;micro Cantonese podcast&rdquo; I&rsquo;m starting on <a href="https://www.instagram.com/meglearnscanto/">Instagram</a> as a way to force myself to practice Cantonese every day and how I automated its creation using Streamlit, <code>ffmpeg</code>, and a Stable Diffusion model.</p>
<h2 id="why-a-micro-podcast">Why a &ldquo;micro&rdquo; podcast?</h2>
<p>The idea was inspired by my significant other. He&rsquo;s been doing yoga for a while and recently he wanted to learn how to do a headstand. We decided to take video recordings so that he&rsquo;d be able to create a compilation of his attempts which would show his progress over time from kicking me in the face to fully upright and unsupported.</p>
<p>As I&rsquo;ve been learning Cantonese, I figured a podcast would be a similar way for me to later appreciate how far I&rsquo;ve come in my acquisition journey. It&rsquo;ll probably take me (a lot) longer to learn decent Cantonese than it has for my boyfriend to learn how to do a headstand, but that&rsquo;s okay.</p>
<h2 id="how-a-micro-podcast">How a &ldquo;micro&rdquo; podcast?</h2>
<p>Once I decided to use a podcast format to document my Cantonese language learning progress, I thought of a few requirements. It should be:</p>
<ul>
<li>Easy to create to remove any barriers that discourage me</li>
<li>Readily indexed and accessible in one place so I can easily look back at old &ldquo;episodes&rdquo;</li>
<li>Fun to make!</li>
</ul>
<p>I settled on uploading (very short) recordings to Instagram as the most lightweight way to get started. Maybe I can aspire to create longer form podcasts when my Cantonese is better, but for now I figure a sentence or two is about right (~10-20 seconds).</p>
<h3 id="prototyping">Prototyping</h3>
<p>Prototyping involved several rounds of iterating on the idea. I first created a &ldquo;prototype&rdquo; by recording myself speaking in an Instagram story on my personal account. I quickly decided that I didn&rsquo;t want to record my face every day. The audio on top of a static image seemed like an easy way to go, but in the spirit of wanting to have some fun, I thought a cute little waveform on top of the video would add some flair.</p>
<p>I did a bit of searching to see if there were apps I could use to add an audio waveform on top of an image to create a video. I found this tool called Wavve which I tested out, but the free tier was really limiting. Here&rsquo;s an example (which I also posted to my personal Instagram):</p>
<video preload="auto" controls style="max-width: 60%; display: block; margin: auto;">
    <source src="/videos/prototype_1.mp4" type="video/mp4">
    There be a video here but your browser does not seem
    to support it.
</video>
<p>At this point, I remembered <code>ffmpeg</code>. I had used this nice command line tool to process audio during my Master&rsquo;s in linguistics (probably while I was doing a PhD, too). But, I needed to create my own images to overlay a waveform on top of. I was able to quickly create some images using a Stable Diffusion model from Hugging Face.</p>
<p>Creating the waveform using <code>ffmpeg</code> was fairly easy in two steps. First, I created a waveform from the audio file (<code>png</code> is important so the background is transparent):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i audio.m4a -filter_complex <span class="s2">&#34;[0:a]showwaves=s=512x200:mode=cline:colors=White@0.75|Black@0.75:draw=full:scale=sqrt,format=rgba[v]&#34;</span> -map <span class="s2">&#34;[v]&#34;</span> -map 0:a -c:v png waveform.mp4<span class="p">;</span></span></span></code></pre></div>
<p>Next, I take the resulting <code>waveform.mp4</code> file and overlay it on top of an image to make a video:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ffmpeg -i image.jpg -i ./input/audio/waveform.mp4 -filter_complex <span class="s2">&#34;[0:v][1:v] overlay=0:300&#34;</span> -pix_fmt yuv420p -c:a copy ./output/canto-2022-12-21-video.mp4</span></span></code></pre></div>
<p>This is what the result looked like:</p>
<video preload="auto" controls style="max-width: 60%; display: block; margin: auto;">
    <source src="/videos/prototype_2.mp4" type="video/mp4">
    There be a video here but your browser does not seem
    to support it.
</video>
<p>Thanks to this prototyping, I had some idea of what I wanted the podcast to look like, but it was kind of a hassle to create &ldquo;manually&rdquo;. I realized I could automate a lot of these steps by using an app and doing so would definitely help me fulfill the &ldquo;easy to create&rdquo; requirement. I&rsquo;m aware of <a href="https://streamlit.io/">Streamlit</a> (they sponsored SLICED!), but I&rsquo;d never personally used it before. Even though I&rsquo;m not a Python person, this still felt like the right tool for the job so I got started.</p>
<h3 id="creating-a-streamlit-app">Creating a Streamlit app</h3>
<p>I began knowing that I wanted to start out with an MVP with some simple requirements for my Streamlit app:</p>
<ol>
<li>Accept an audio file</li>
<li>Generate a downloadable video of the audio and its waveform overlaid on top of an image</li>
</ol>
<p>Ready to begin coding everything up, I joked to my boyfriend that I was living the &ldquo;draw the owl&rdquo; meme. &ldquo;Simply install Python on Windows&rdquo;. Okay. Anyway, next I simply installed Python on my Windows laptop. Maybe you consider me basic at this point but I&rsquo;ll remind you of two things:</p>
<ol>
<li>Imagine for a moment how much blood, tears, and sweat I&rsquo;ve saved data scientists around the world by offering a fully managed Python Docker image on Kaggle, the product I work on</li>
<li>I just attended <a href="https://normconf.com/">#NormConf</a> a few weeks ago, so I know the struggles are real!</li>
</ol>
<p>With Python installed, I could begin! Not knowing much Python or Streamlit, I figured the best way to get a grip on things would be to find simple, publicly available examples that I could take inspiration from. I found <a href="https://bgremoval.streamlit.app/">this app</a> which looked very simple and did many of the things I wanted to do: 1) it accepted a user uploaded file; 2) used that file to generate some other output. Browsing <a href="https://github.com/tyler-simons/BackgroundRemoval">their code</a> helped me learn a lot about how Streamlit works.</p>
<p>Finally, I began creating my MVP app! I won&rsquo;t go into details of the code here, but you can <a href="https://github.com/mrisdal/canto-podcast-creator">check out the code on my GitHub</a>.</p>
<p>Creating the MVP was quite easy. But, once I had something basic working, I wanted to make at least one additional improvement: instead of a single background image, I wanted to be able to select from a set of possible images. I thought this might be a Streamlit component that I could use out-of-the-box, but it wasn&rsquo;t. Fortunately, I found someone else, <a href="https://github.com/jrieke">Johannes Rieke</a> (a Streamlit product manager), had created a <a href="https://github.com/jrieke/streamlit-image-select">custom image selector component</a>. From there, it was simply a matter of using the custom component to add an image selection UI and creating a small library of images (again using Stable Diffusion hosted on Hugging Face).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># Select a background image</span>
</span></span><span class="line"><span class="cl"><span class="n">st</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&#34;## Step 2. Choose a background image&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">backgrounds</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">background_input_path</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Check if current path is a file and add it to a list</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># All the files here should be images. They don&#39;t need to be the same size, but ideally they&#39;re square</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">background_input_path</span><span class="p">,</span> <span class="n">path</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">backgrounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">background_input_path</span> <span class="o">+</span> <span class="n">path</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Image selector widget</span>
</span></span><span class="line"><span class="cl"><span class="n">selected_image</span> <span class="o">=</span> <span class="n">image_select</span><span class="p">(</span><span class="s2">&#34;Background choices&#34;</span><span class="p">,</span> <span class="n">backgrounds</span><span class="p">)</span></span></span></code></pre></div>
<p>The resulting app is embedded below and <a href="https://mrisdal-canto-podcast-creator-create-podcast-oselu7.streamlit.app/">available at this link</a>. I also added it to a tab called Cantonese on my own website so I can easily access it from my phone where I make the recordings.</p>

    <iframe
        src="https://mrisdal-canto-podcast-creator-create-podcast-oselu7.streamlit.app/?embedded=true"
        title="iframed content"
        height="600"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        scrolling="no"
        style="border: 1px solid #CCC; border-width: 1px; margin-bottom: 20px; width: 100%;"
        allowfullscreen="true">
    </iframe>

<p>There&rsquo;s a few other ways I briefly explored extending the app before I called everything done. Here&rsquo;s what I didn&rsquo;t do:</p>
<ul>
<li><strong>Use a pre-trained model to generate new background images on the fly</strong>. I decided the expense wasn&rsquo;t worth it as this would require I pay some hosting provider to make inference calls. Instead I&rsquo;ll have to manually refresh the images from time-to-time, but for now I find this acceptable.</li>
<li><strong>Create transcripts</strong>. I briefly looked into using Google&rsquo;s Translation API to to create HK Cantonese &ndash;&gt; English transcripts which I could use either as captions for my Instagram posts or within the videos themselves. Similarly, I decided I didn&rsquo;t want to bother paying for this. Plus, since I can&rsquo;t read Chinese characters I&rsquo;d have no way to verify their accuracy (risky since I&rsquo;m obviously a beginning learner, not a native speaker).</li>
</ul>
<h2 id="launch">Launch!</h2>
<p>With my Cantonese podcast app ready, I now have zero excuses! I can easily create short, visually appealing videos for my Instagram every day to help me learn and record progress. I &ldquo;launched&rdquo; the app by creating an <a href="https://www.instagram.com/meglearnscanto/">Instagram <code>meglearnscanto</code></a> and lightly promoting it so that I felt like I had some kind of friendly audience, even if small.</p>
<video preload="auto" controls style="max-width: 60%; display: block; margin: auto;">
    <source src="/videos/final_1.mp4" type="video/mp4">
    There be a video here but your browser does not seem
    to support it.
</video>
<p>Thank you for reading! I&rsquo;d also like to thank my boyfriend for his support and inspiration as well as folks on Streamlit&rsquo;s forums who helped me with some troubleshooting.</p>
<p>P.S. If you&rsquo;re wondering what&rsquo;s with all the rabbits it&rsquo;s beause my birthyear is 1987, year of the rabbit. The next year of the rabbit begins in 2023!</p>
<p>&ndash;</p>
<h2 id="reply">Reply</h2>
<p>Follow the conversation on Twitter.</p>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">I wrote about why and how I created my &quot;micro Cantonese podcast&quot; <a href="https://t.co/Ooyu3KyJ1t">https://t.co/Ooyu3KyJ1t</a></p>&mdash; meg.ehh 🇨🇦 (@MeganRisdal) <a href="https://twitter.com/MeganRisdal/status/1608566221263503361?ref_src=twsrc%5Etfw">December 29, 2022</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<p><em>I created this post&rsquo;s banner image by using another fun CLI tool, ImageMagick, to mash together three images generated by a Stable Diffusion model</em></p>

    </div>
  </div>

    <div class="footer">
    
    <div class="footer-social">
      
        <span class="social-icon social-icon-twitter">
          <a href="https://twitter.com/meganrisdal" title="twitter" target="_blank" rel="noopener">
            <img src="/images/social/twitter.svg" width="24" height="24" alt="twitter"/>
          </a>
        </span>
      
        <span class="social-icon social-icon-github">
          <a href="https://github.com/mrisdal" title="github" target="_blank" rel="noopener">
            <img src="/images/social/github.svg" width="24" height="24" alt="github"/>
          </a>
        </span>
      
        <span class="social-icon social-icon-linkedin">
          <a href="https://www.linkedin.com/in/megan-risdal-4617812a/" title="linkedin" target="_blank" rel="noopener">
            <img src="/images/social/linkedin.svg" width="24" height="24" alt="linkedin"/>
          </a>
        </span>
      
        <span class="social-icon social-icon-mastodon">
          <a href="https://mastodon.social/@meganrisdal" title="mastodon" target="_blank" rel="noopener">
            <img src="/images/social/mastodon.svg" width="24" height="24" alt="mastodon"/>
          </a>
        </span>
      
        <span class="social-icon social-icon-kaggle">
          <a href="https://kaggle.com/mrisdal" title="kaggle" target="_blank" rel="noopener">
            <img src="/images/social/kaggle.svg" width="24" height="24" alt="kaggle"/>
          </a>
        </span>
      
        <span class="social-icon social-icon-letterboxd">
          <a href="https://letterboxd.com/mrisdal/" title="letterboxd" target="_blank" rel="noopener">
            <img src="/images/social/letterboxd.svg" width="24" height="24" alt="letterboxd"/>
          </a>
        </span>
      
        <span class="social-icon social-icon-instagram">
          <a href="https://www.instagram.com/meglearnscanto/" title="instagram" target="_blank" rel="noopener">
            <img src="/images/social/instagram.svg" width="24" height="24" alt="instagram"/>
          </a>
        </span>
      
        <span class="social-icon social-icon-rss">
          <a href="https://www.meg.dev/feed.xml" title="rss" target="_blank" rel="noopener">
            <img src="/images/social/rss.svg" width="24" height="24" alt="rss"/>
          </a>
        </span>
      
      <div style="float: right;">
        <span>&copy; 2023 Meg Risdal - <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></span>
      </div>
    </div>
    </div>
    
  </div>
  </div>

  

  

  
  <script type="text/javascript" src="/js/bundle.min.5993fcb11c07dea925a3fbd58c03c7f1857197c35fccce3aa963a12c0b3c9960.js"></script>
  

  
  

  
  
  
    
      
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-127474557-1"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-127474557-1');
      </script>
    
  

  


</body>
</html>